<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>D3X Keeper</title>
    <style>
        :root { --neon: #bc13fe; --bg: #0f0c1f; --card-bg: rgba(255, 255, 255, 0.05); --text: #e0e0e0; --discord: #5865F2; }
        .light-mode { --bg: #f5f5f7; --card-bg: #ffffff; --text: #1d1d1f; }
        
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; transition: 0.2s; }
        body { background: var(--bg); color: var(--text); display: flex; flex-direction: column; align-items: center; min-height: 100vh; padding: 15px; }
        
        .top-bar { width: 100%; max-width: 900px; display: flex; justify-content: space-between; gap: 8px; margin-bottom: 15px; }
        .control-btn { flex: 1; background: rgba(188, 19, 254, 0.1); border: 1px solid var(--neon); color: var(--neon); padding: 10px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 0.75rem; text-decoration: none; display: flex; align-items: center; justify-content: center; }
        
        .container { width: 100%; max-width: 900px; background: var(--card-bg); backdrop-filter: blur(20px); border: 1px solid rgba(188, 19, 254, 0.3); border-radius: 20px; padding: 25px; flex-grow: 1; }
        .brand { text-align: center; font-size: 2.5rem; font-weight: 900; color: var(--neon); text-shadow: 0 0 15px var(--neon); margin-bottom: 20px; }
        
        .add-section { display: flex; flex-direction: column; gap: 10px; margin-bottom: 30px; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 15px; border: 1px solid var(--neon); }
        input, textarea { width: 100%; background: rgba(0,0,0,0.4); border: 1px solid rgba(188, 19, 254, 0.3); border-radius: 10px; padding: 12px; color: var(--text); outline: none; }
        textarea { height: 120px; resize: none; font-family: monospace; direction: ltr; }
        
        .btn-row { display: flex; gap: 10px; }
        .main-btn { flex: 2; background: var(--neon); color: white; border: none; padding: 12px; border-radius: 10px; font-weight: bold; cursor: pointer; }
        .upload-label { flex: 1; border: 1px solid var(--neon); color: var(--neon); padding: 12px; border-radius: 10px; cursor: pointer; text-align: center; font-size: 0.85rem; }
        
        #keep-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(min(100%, 280px), 1fr)); gap: 15px; }
        .card { background: rgba(255,255,255,0.03); border: 1px solid rgba(188,19,254,0.15); border-radius: 15px; padding: 15px; }
        .card h3 { color: var(--neon); font-size: 1.1rem; margin-bottom: 12px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 6px; }
        .btn { padding: 8px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 0.75rem; color: white; }
        .btn-copy { background: #1a73e8; }
        .btn-view { background: #34a853; }
        .btn-edit { background: #fbbc05; color: #000; }
        .btn-del { background: #ea4335; }
        .btn-down { background: #673ab7; grid-column: span 2; }
        
        /* Modals */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 1000; justify-content: center; align-items: center; padding: 20px; }
        .modal-content { background: var(--bg); border: 2px solid var(--neon); width: 100%; max-width: 650px; border-radius: 20px; padding: 20px; position: relative; }
        .close-btn { position: absolute; top: 10px; left: 20px; color: var(--neon); font-size: 2rem; cursor: pointer; }
        pre#viewArea { background: #000; color: #0f0; padding: 15px; border-radius: 10px; max-height: 400px; overflow: auto; direction: ltr; text-align: left; }
        
        .footer { margin-top: 30px; padding: 20px; color: #888; font-size: 0.8rem; text-align: center; border-top: 1px solid rgba(188,19,254,0.1); width: 100%; max-width: 900px; }
        body.en { direction: ltr; }
    </style>
</head>
<body id="body">

    <div class="top-bar">
        <button class="control-btn" onclick="toggleLang()" id="langBtn">English</button>
        <a href="https://discord.gg/QhZsPzpp" target="_blank" class="control-btn" style="background:var(--discord); border:none; color:white;">Discord üí¨</a>
        <button class="control-btn" onclick="toggleTheme()" id="themeBtn">üåô Mode</button>
    </div>

    <div class="container">
        <div class="brand">D3X Keeper</div>
        <div class="add-section">
            <input type="text" id="titleInp" placeholder="">
            <textarea id="codeInp" placeholder=""></textarea>
            <div class="btn-row">
                <button class="main-btn" onclick="handleSave()" id="saveBtn">ÿ≠ŸÅÿ∏ üíæ</button>
                <label for="fileInp" class="upload-label" id="upBtn">ÿ±ŸÅÿπ ŸÖŸÑŸÅ üìÅ</label>
                <input type="file" id="fileInp" style="display:none" onchange="importFile(this)">
            </div>
        </div>
        <div id="keep-list"></div>
    </div>

    <div id="viewModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModals()">&times;</span>
            <h2 id="viewTitle" style="color:var(--neon); margin-bottom:10px;"></h2>
            <pre id="viewArea"></pre>
        </div>
    </div>

    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModals()">&times;</span>
            <h2 id="editModalTitle" style="color:var(--neon); margin-bottom:15px;"></h2>
            <input type="text" id="editTitleInp" style="margin-bottom:10px;">
            <textarea id="editCodeInp" style="height:250px; margin-bottom:15px;"></textarea>
            <button class="main-btn" style="width:100%" onclick="saveEdit()" id="updateBtn">ÿ™ÿ≠ÿØŸäÿ´ üîÑ</button>
        </div>
    </div>

    <footer class="footer" id="footerText"></footer>

    <script>
        let scripts = JSON.parse(localStorage.getItem('d3x_keeper_v5')) || [];
        let curLang = 'ar', dark = true, currentEditId = null;

        const trans = {
            ar: { 
                titlePh: "ÿßÿ≥ŸÖ ÿßŸÑÿ≥ŸÉÿ±Ÿäÿ®ÿ™...", 
                codePh: "-- ÿßŸÑÿµŸÇ ÿßŸÑŸÉŸàÿØ ŸáŸÜÿß ÿ£Ÿà ÿßÿ±ŸÅÿπ ŸÖŸÑŸÅÿßŸã", 
                save: "ÿ≠ŸÅÿ∏ üíæ", 
                up: "ÿ±ŸÅÿπ ŸÖŸÑŸÅ üìÅ", 
                copy: "ŸÜÿ≥ÿÆ", 
                view: "ŸÅÿ™ÿ≠", 
                edit: "ÿ™ÿπÿØŸäŸÑ", 
                del: "ÿ≠ÿ∞ŸÅ", 
                down: "ÿ™ŸÜÿ≤ŸäŸÑ .lua ‚¨áÔ∏è",
                footer: "ÿ≠ŸÇŸàŸÇ ÿßŸÑÿ∑ÿ®ÿπ ŸàÿßŸÑŸÜÿ¥ÿ± ŸÖÿ≠ŸÅŸàÿ∏ÿ© ŸÑŸÄ D3M0N3T3R5 ¬© 2026",
                update: "ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ≥ŸÉÿ±ÿ®ÿ™ üîÑ",
                editHead: "ÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ≥ŸÉÿ±ÿ®ÿ™",
                confirmDel: "ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßŸÑÿ≠ÿ∞ŸÅÿü",
                copied: "ÿ™ŸÖ ÿßŸÑŸÜÿ≥ÿÆ! ‚úÖ"
            },
            en: { 
                titlePh: "Script Name...", 
                codePh: "-- Paste code here or upload file", 
                save: "Save üíæ", 
                up: "Upload üìÅ", 
                copy: "Copy", 
                view: "View", 
                edit: "Edit", 
                del: "Delete", 
                down: "Download .lua ‚¨áÔ∏è",
                footer: "Copyright Reserved to D3M0N3T3R5 ¬© 2026",
                update: "Update Script üîÑ",
                editHead: "Edit Script",
                confirmDel: "Are you sure you want to delete?",
                copied: "Copied! ‚úÖ"
            }
        };

        function toggleTheme() { dark = !dark; document.body.classList.toggle('light-mode'); }
        
        function toggleLang() { 
            curLang = curLang === 'ar' ? 'en' : 'ar'; 
            document.body.dir = curLang === 'ar' ? 'rtl' : 'ltr';
            document.body.classList.toggle('en', curLang === 'en');
            updateUI(); 
        }

        function handleSave() {
            const t = document.getElementById('titleInp').value, c = document.getElementById('codeInp').value;
            if(!t || !c) return;
            scripts.unshift({ id: Date.now(), title: t, code: c });
            saveData();
            document.getElementById('titleInp').value = ''; document.getElementById('codeInp').value = '';
            updateUI();
        }

        function importFile(input) {
            const file = input.files[0];
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('codeInp').value = e.target.result;
                document.getElementById('titleInp').value = file.name.replace(/\.[^/.]+$/, "");
            };
            reader.readAsText(file);
        }

        function openEdit(id) {
            currentEditId = id;
            const s = scripts.find(x => x.id === id);
            document.getElementById('editTitleInp').value = s.title;
            document.getElementById('editCodeInp').value = s.code;
            document.getElementById('editModal').style.display = 'flex';
        }

        function saveEdit() {
            const idx = scripts.findIndex(x => x.id === currentEditId);
            scripts[idx].title = document.getElementById('editTitleInp').value;
            scripts[idx].code = document.getElementById('editCodeInp').value;
            saveData();
            closeModals();
            updateUI();
        }

        function view(id) {
            const s = scripts.find(x => x.id === id);
            document.getElementById('viewTitle').innerText = s.title;
            document.getElementById('viewArea').innerText = s.code;
            document.getElementById('viewModal').style.display = 'flex';
        }

        function copyScript(id) {
            const s = scripts.find(x => x.id === id);
            navigator.clipboard.writeText(s.code).then(() => alert(trans[curLang].copied));
        }

        function downloadScript(id) {
            const s = scripts.find(x => x.id === id);
            const blob = new Blob([s.code], { type: 'text/plain' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `${s.title}.lua`;
            a.click();
        }

        function del(id) { 
            if(confirm(trans[curLang].confirmDel)) { 
                scripts = scripts.filter(x => x.id !== id); 
                saveData(); 
                updateUI(); 
            } 
        }

        function closeModals() { 
            document.getElementById('viewModal').style.display = 'none'; 
            document.getElementById('editModal').style.display = 'none'; 
        }

        function saveData() { localStorage.setItem('d3x_keeper_v5', JSON.stringify(scripts)); }

        function updateUI() {
            const t = trans[curLang];
            document.getElementById('langBtn').innerText = curLang === 'ar' ? 'English' : 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©';
            document.getElementById('titleInp').placeholder = t.titlePh;
            document.getElementById('codeInp').placeholder = t.codePh;
            document.getElementById('saveBtn').innerText = t.save;
            document.getElementById('upBtn').innerText = t.up;
            document.getElementById('footerText').innerText = t.footer;
            document.getElementById('editModalTitle').innerText = t.editHead;
            document.getElementById('updateBtn').innerText = t.update;

            const list = document.getElementById('keep-list');
            list.innerHTML = scripts.map(s => `
                <div class="card">
                    <h3>${s.title}</h3>
                    <div class="btn-grid">
                        <button class="btn btn-copy" onclick="copyScript(${s.id})">${t.copy}</button>
                        <button class="btn btn-view" onclick="view(${s.id})">${t.view}</button>
                        <button class="btn btn-edit" onclick="openEdit(${s.id})">${t.edit}</button>
                        <button class="btn btn-down" onclick="downloadScript(${s.id})">${t.down}</button>
                        <button class="btn btn-del" onclick="del(${s.id})">${t.del}</button>
                    </div>
                </div>
            `).join('');
        }
        updateUI();
    </script>
</body>
</html>
